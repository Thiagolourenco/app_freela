webpackJsonp([51],{1037:function(t,e,i){t.exports={"widget-file-attachment-dropzone":Promise.all([i.e(0),i.e(51)]).then(i.bind(null,4219)),"widget-file-attachment-inline":Promise.all([i.e(0),i.e(51)]).then(i.bind(null,4220)),"widget-file-attachment-picker":Promise.all([i.e(0),i.e(51)]).then(i.bind(null,4221)),"widget-file-viewer":Promise.all([i.e(0),i.e(51)]).then(i.bind(null,4224)),"widget-file-documenteditor":Promise.all([i.e(0),i.e(51)]).then(i.bind(null,4222))}},3061:function(t,e){t.exports='\x3c!--ko if: $component.hasFilesPermissions() || $component.genericUpload() --\x3e\n    <section class="w-file-dropzone" data-bind="css: params.notifyKey + \' \' + theme, visible: fileDropZoneShowing()">\n\n        <h3 class="w-file-dropzone__title" data-bind="visible: theme !== \'AddProjectFiles\'">\n            {{app.tl(\'Files\')}}\n        </h3>\n\n        <div class="w-file-dropzone__content w-file-dropzone__blur">\n\n            <div class="w-file-dropzone__files-wrapper" data-bind="css: { \'is-adding-project-files\': theme == \'AddProjectFiles\', \'has-no-attachments\': uploadedFiles().length == 0 && selectedExistingFiles().length == 0 && attachmentsCount() == 0 }">\n\n                \x3c!-- ko if: $component.isDropTitleShown() --\x3e\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{{ app.tl(\'Drop or Paste Files Here\') }}\n\t\t\t\t\t</p>\n                \x3c!--/ko--\x3e\n\n\t\t\t\t\x3c!-- ko if: uploadedFiles().length > 0  || selectedExistingFiles().length > 0 || attachmentsCount() > 0 --\x3e\n\n\t\t\t\t\t\x3c!-- ko ifnot: theme == \'AddProjectFiles\' --\x3e\n\t\t\t\t\t\t<div class="w-uploaded-files__row--category-only">\n\t\t\t\t\t\t\t<h4 class="w-file-dropzone__category-heading">\n\t\t\t\t\t\t\t\t{{ app.tl(\'Category\') }}\n\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!--/ko--\x3e\n\n                    <ul class="w-uploaded-files">\n\n\t\t\t\t\t\t\x3c!-- ko foreach: uploadedFiles --\x3e\n\n\t\t\t\t\t\t\t<li class="w-uploaded-files__row is-uploading" data-bind="visible: $data.status() != \'complete\'">\n\t\t\t\t\t\t\t\t<div class="w-uploading-file">\n\n\t\t\t\t\t\t\t\t\t<a href="javascript();" class="w-uploading-file__cancel" data-bind="click: $component.OnClickCancelSpecificUpload">\n\t\t\t\t\t\t\t\t\t\t<i class="fa fa-times h-pointer-e--none" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t<span class="sr-only">\n\t\t\t\t\t\t\t\t\t\t\t{{ app.tl(\'Cancel\') }}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t\t\t\t<span class="w-uploading-file__progress">\n\t\t\t\t\t\t\t\t\t\t<span class="w-uploading-file__progress-label">\n\t\t\t\t\t\t\t\t\t\t\t{{ $data.progress() }}%\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span class="w-uploading-file__progress-holder">\n\t\t\t\t\t\t\t\t\t\t\t<span class="w-uploading-file__file-name">\n\t\t\t\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{ app.utility.getSafeFileName($data.name).fileName }}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="w-uploading-file__progress-bar" data-bind="style: { \'width\' : $data.progress() + \'%\'}"></span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\n\t\t\t\t\t\t\t<li class="w-uploaded-files__row" data-bind="visible: $data.status() == \'complete\'">\n\n\t\t\t\t\t\t\t\t\x3c!-- ko if: $component.theme == \'AddProjectFiles\' --\x3e\n\t\t\t\t\t\t\t\t\t<div class="w-uploaded-files__checkbox">\n\t\t\t\t\t\t\t\t\t\t\x3c!-- ko if: $component.onlyOneFile --\x3e\n\t\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" data-bind="click: $component.OnClickCancelSpecificUpload" title="{{app.tl(\'Remove\')}}">\n\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-trash" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\t\t\t\t\t\t\t\t\t\t\x3c!-- ko ifnot: $component.onlyOneFile --\x3e\n\t\t\t\t\t\t\t\t\t\t\t<input type="checkbox" class="inline notracking m--none" data-bind="checked: checked, click: $component.OnClickIncludeFile">\n\t\t\t\t\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="w-uploaded-files__file-data" title="{{ app.utility.getSafeFileName(name).fileName }}" data-bind="css: { \'is-removed\' : !checked() }">\n\t\t\t\t\t\t\t\t\t\t<span class="w-uploaded-files__file-icon">\n\t\t\t\t\t\t\t\t\t\t\t<img data-bind="attr: {src: icon}, event: {error: app.OnImageThumbLoadFail.bind($data,\'attachmentIcon\')}">\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span class="w-uploaded-files__file-name">\n\t\t\t\t\t\t\t\t\t\t\t{{app.utility.getSafeFileName(name).fileName}}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t\t\t\t\t\t\x3c!-- ko ifnot: $component.theme == \'AddProjectFiles\' --\x3e\n\t\t\t\t\t\t\t\t\t<div class="w-uploaded-files__checkbox">\n\t\t\t\t\t\t\t\t\t\t<input type="checkbox" class="inline notracking m--none" data-bind="checked: checked, click: $component.OnClickIncludeFile">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="w-uploaded-files__file-data" title="{{ app.utility.getSafeFileName(name).fileName }}" data-bind="css: { \'is-removed\' : !checked() }">\n\t\t\t\t\t\t\t\t\t\t<span class="w-uploaded-files__file-name">\n\t\t\t\t\t\t\t\t\t\t\t{{app.utility.getSafeFileName(name).fileName}}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="w-uploaded-files__file-category" data-bind="visible: checked()">\n\t\t\t\t\t\t\t\t\t\t\x3c!-- ko component: { name: \'widget-tipped-category\', params: { projectId: $component.parentVM.projectId, type: \'files\', categoryId: categoryId } } --\x3e\x3c!-- /ko --\x3e\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t\t\t\t\t</li>\n\n\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t\t\t\t\x3c!-- ko foreach: selectedExistingFiles --\x3e\n\t\t\t\t\t\t\t<li class="w-uploaded-files__row js-selectExistingFiles">\n\t\t\t\t\t\t\t\t<div class="w-uploaded-files__checkbox">\n\t\t\t\t\t\t\t\t\t<input type="checkbox" class="inline notracking m--none" data-bind="checked: checked, click: $component.OnClickIncludeFile">\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class="w-uploaded-files__file-data" title="{{ app.utility.getSafeFileName(name).fileName }}" data-bind="css: { \'is-removed\' : !checked() } ">\n\t\t\t\t\t\t\t\t\t<span class="w-uploaded-files__file-icon">\n\t\t\t\t\t\t\t\t\t\t<img data-bind="attr: {src: icon}, event: {error: app.OnImageThumbLoadFail.bind($data,\'attachmentIcon\')}">\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<a target="_blank" class="w-uploaded-files__file-name" href="./?action=viewFile&fileId={{id}}">\n\t\t\t\t\t\t\t\t\t\t{{app.utility.getSafeFileName(name).fileName}}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class="w-uploaded-files__file-category">\n\t\t\t\t\t\t\t\t\t\x3c!-- ko component: { name: \'widget-tipped-category\', params: { projectId: $component.parentVM.projectId, type: \'files\', categoryId: categoryId } } --\x3e\x3c!-- /ko --\x3e\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t\t\t\t\x3c!-- ko foreach: attachedTo.attachments --\x3e\n\t\t\t\t\t\t\t<li class="w-uploaded-files__row">\n\t\t\t\t\t\t\t\t<div class="w-uploaded-files__checkbox">\n\t\t\t\t\t\t\t\t\t<input type="checkbox" class="inline notracking m--none" data-bind="checked: checked, click: $component.OnClickIncludeFile">\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class="w-uploaded-files__file-data" title="{{ app.utility.getSafeFileName(name).fileName }}" data-bind="css: { \'is-removed\' : !checked() } ">\n\t\t\t\t\t\t\t\t\t<span class="w-uploaded-files__file-icon">\n\t\t\t\t\t\t\t\t\t\t<img data-bind="attr: {src: $component.getAttachmentIcon($data)}, event: {error: app.OnImageThumbLoadFail.bind($data,\'attachmentIcon\')}">\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<a target="_blank" class="w-uploaded-files__file-name" href="./?action=viewFile&fileId={{id}}">\n\t\t\t\t\t\t\t\t\t\t{{app.utility.getSafeFileName(name).fileName}}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class="w-uploaded-files__file-category">\n\t\t\t\t\t\t\t\t\t\x3c!-- ko component: { name: \'widget-tipped-category\', params: { projectId: $component.parentVM.projectId, type: \'files\', categoryId: categoryId } } --\x3e\x3c!-- /ko --\x3e\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\n                    </ul>\n\n\t\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t</div>\n\n\t\t\t\x3c!-- ko if: theme == \'AddProjectFiles\' --\x3e\n\t\t\t\t<div class="w-file-dropzone__action-block" data-bind="visible: attachedFilesCount() == 0 || !onlyOneFile(), css: {\'only-one-file\': onlyOneFile(), \'has-files\': attachedFilesCount() > 0}">\n\t\t\t\t\t<p data-bind="visible: uploadedFiles().length == 0">\n\t\t\t\t\t\t{{ onlyOneFile() ? app.tl(\'Drop file here or click\') : app.tl(\'Drop files here or click\') }}\n\t\t\t\t\t</p>\n\t\t\t\t\t<input class="w-file-dropzone__action-block-input" data-bind="attr:{ id: \'selectingFilesInputTarget1\' + params.notifyKey, \'multiple\': (onlyOneFile()?false:true)}" name="file" type="file" value="Select files..">\n\t\t\t\t\t<label data-bind="attr:{ for: \'selectingFilesInputTarget1\' + params.notifyKey }, style: { align-self: uploadedFiles().length > 0 ? \'flex-start\' : \'center\' }, visible: !(onlyOneFile() && uploadedFiles().length > 0) && !$component.attachedTo.isSubmitting() " class="btn btn-primary w-file-dropzone__action-block-button">\n\t\t\t\t\t\t<i class="fa fa-plus" aria-hidden="true"></i>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ onlyOneFile() ? app.tl(\'Add File\') : app.tl(\'Add Files\') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t\x3c!-- ko ifnot: theme == \'AddProjectFiles\' --\x3e\n\t\t\t\t<div class="w-file-dropzone__action-buttons">\n\t\t\t\t\t<div>\n\n\t\t\t\t\t\t<input class="w-file-dropzone__action-block-input" type="file" name="file" multiple="true" data-bind="attr:{id: \'selectingFilesInputTarget2\' + params.notifyKey, \'value\':app.tl(\'Select Files\')+app.localizationPreferences().ellipsis}">\n\t\t\t\t\t\t<label data-bind="attr:{ for: \'selectingFilesInputTarget2\' + params.notifyKey }, visible: !(onlyOneFile() && uploadedFiles().length > 0) && canUploadFilesDirectly()"  class="btn btn-default btn-sm w-file-dropzone__action-block-button">\n\t\t\t\t\t\t\t<i class="fa fa-plus" aria-hidden="true"></i>\n\t\t\t\t\t\t\t<span>{{app.tl("Add Files")}}</span>\n\t\t\t\t\t\t</label>\n\n\t\t\t\t\t\t<button type="button" class="btn btn-default btn-sm" data-bind="click: OnSelectFromExistingFiles">\n\t\t\t\t\t\t\t{{app.tl(\'Select from Existing Files\')}}{{{app.localizationPreferences().ellipsis}}}\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\x3c!-- ko if: canAccessDropbox() --\x3e\n\t\t\t\t\t\t\t<button type="button" class="btn btn-default btn-sm dropbox-upload-files" data-bind="click: OnClickDropboxUI">\n\t\t\t\t\t\t\t\t<img class="widgetDropzone_cloud" src="//cdn.teamwork.com/images/integrations/dropbox/dropbox16x16.png" border="0" width="16" height="16">\n\t\t\t\t\t\t\t\tDropbox\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\x3c!--/ko--\x3e\n\n\t\t\t\t\t\t\x3c!-- ko if: canAccessGoogleDocs() --\x3e\n\t\t\t\t\t\t\t<button type="button" class="btn btn-default btn-sm google-upload-files" data-bind="click: OnClickGoogleDriveUI">\n\t\t\t\t\t\t\t\t<img class="widgetDropzone_cloud" src="//cdn.teamwork.com/images/integrations/googleDocs/googleDocs16x16.png" border="0" width="16" height="16">\n\t\t\t\t\t\t\t\tGoogle Drive\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\x3c!--/ko--\x3e\n\n\t\t\t\t\t\t\x3c!-- ko if: canAccessBoxFiles() --\x3e\n\t\t\t\t\t\t\t<button type="button" class="btn btn-default btn-sm box-upload-files" data-bind="click: OnClickBoxComUI">\n\t\t\t\t\t\t\t\t<img class="widgetDropzone_cloud" src="//cdn.teamwork.com/images/integrations/boxFiles/boxFiles16x16.png" border="0" width="16" height="16">\n\t\t\t\t\t\t\t\tBOX.com\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\x3c!--/ko--\x3e\n\n\t\t\t\t\t\t\x3c!-- ko if: canAccessOneDrive() --\x3e\n\t\t\t\t\t\t\t<button type="button" class="btn btn-default btn-sm onedrive-upload-files" data-bind="click: OnClickOneDriveUI">\n\t\t\t\t\t\t\t\t<img class="widgetDropzone_cloud" src="//cdn.teamwork.com/images/integrations/oneDrive/oneDriveFiles16x16.png" border="0" width="16" height="16">\n\t\t\t\t\t\t\t\tOneDrive\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\x3c!--/ko--\x3e\n\n\t\t\t\t\t\t\x3c!-- ko if: canAccessOneDriveBusiness() --\x3e\n\t\t\t\t\t\t\t<button type="button" class="btn btn-default btn-sm odb-upload-files" data-bind="click: OnClickOneDriveBusinessUI">\n\t\t\t\t\t\t\t\t<img class="widgetDropzone_cloud" src="//cdn.teamwork.com/images/integrations/oneDrive/oneDriveFiles16x16.png" border="0" width="16" height="16">\n\t\t\t\t\t\t\t\tOneDrive Business\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\x3c!--/ko--\x3e\n\n\t\t\t\t\t\t\x3c!-- ko if: canAccessSharePoint() --\x3e\n\t\t\t\t\t\t\t<button type="button" class="btn btn-default btn-sm odb-upload-files" data-bind="click: OnClickSharePointUI">\n\t\t\t\t\t\t\t\t<img class="widgetDropzone_cloud" src="//cdn-pjs.teamwork.com/tko/public/assets/integrations/sharepoint/sharepoint16x16.png" border="0" width="16" height="16">\n\t\t\t\t\t\t\t\tSharePoint\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\x3c!--/ko--\x3e\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\x3c!--/ko--\x3e\n\n        </div>\n\n    </section>\n\x3c!--/ko--\x3e\n\n\x3c!-- IMPORTANT - Mark this template loaded --\x3e\n<div data-bind="template: {afterRender: function(){templateLoaded(true)}}" class="hidden"></div>'},3062:function(t,e){t.exports='<div class="fileDropZone" data-bind="css: params.notifyKey+\' \'+theme">\n\n\t<input class="hiddenFile" type="file" style="cursor: pointer; display:none;" name="file" multiple="true" data-bind="attr:{\'value\':app.tl(\'Select Files\')+app.localizationPreferences().ellipsis}">\n\n\t\x3c!-- ko if: uploadedFiles().length > 0 --\x3e\n\n\t\t<div class="py--medium">\n\n\t\t\t<div class="w-uploading-file">\n\n\t\t\t\t<a href="javascript();" class="w-uploading-file__cancel" data-bind="click: OnClickCancelUploadInline">\n\t\t\t\t\t<i class="fa fa-times h-pointer-e--none" aria-hidden="true"></i>\n\t\t\t\t\t<span class="sr-only">\n\t\t\t\t\t\tCancel Upload\n\t\t\t\t\t</span>\n\t\t\t\t</a>\n\n\t\t\t\t<span class="w-uploading-file__progress">\n\t\t\t\t\t<span class="w-uploading-file__progress-label">\n\t\t\t\t\t\t{{ $component.currentAddFile.s3.files.progress }} %\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="w-uploading-file__progress-holder">\n\t\t\t\t\t\t<span class="w-uploading-file__file-name">\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{{ $component.fileUploadingMessage }}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class="w-uploading-file__progress-bar" data-bind="style: { \'width\' : $component.currentAddFile.s3.files.progress() + \'%\'}"></span>\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\n\t\t\t</div>\n\n\t\t</div>\n\n\t\x3c!--/ko--\x3e\n\n</div>\n\n\x3c!-- IMPORTANT - Mark this template loaded --\x3e\n<div data-bind="template:{afterRender:function(){templateLoaded(true)}}" class="hidden"></div>'},3063:function(t,e){t.exports='\x3c!--ko if: $component.hasFilesPermissions() --\x3e\n<div class="widgetFileAttachmentPicker" style="display:inline-block; vertical-align:top; margin-right:10px;">\n\t<label class="block font-weight--semi-bold">{{app.tl("Files")}}</label>\n\t<div>\n\t\t<a href="javascript:" data-bind="click: OnShowFilePicker" class="ppd text-decoration--none">\n\n\t\t\t<i class="fa fa-paperclip fa-rotate-90 mr--small"></i>\n\n\t\t\t\x3c!-- ko if:  attachmentsCount() == 0 --\x3e\n\t\t\t\t<span class="attach">{{app.tl("Attach a File")}}</span>\n\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t\x3c!-- ko if: attachmentsCount() > 0 --\x3e\n\t\t\t\t<span class="attach">{{app.tl(\'[_s] attached files\', $data.params.attachedTo.attachmentsCount)}}</span>\n\t\t\t\x3c!-- /ko --\x3e\n\t\t</a>\n\t</div>\n</div>\n\x3c!-- /ko --\x3e\n'},3064:function(t,e){t.exports='\x3c!--ko if: app.isDocumentEditorEnabled() && isEditableFile() && projectIsActive() && file && file.canEdit() --\x3e\n\n    \x3c!-- ko if: isCloudStorageFile() && isOnlineEditable() --\x3e\n        \x3c!-- ko if: type == \'icon\' --\x3e\n            <a class="fileEdit" data-bind="click:$data.OnClickEditFileOneDrive" href="javascript:;"><i class=\'fa fa-pencil\' aria-hidden="true"></i></a>\n        \x3c!-- /ko --\x3e\n        \x3c!-- ko if: type == \'link\' --\x3e\n            <a class="fileLink" data-bind="click: $data.OnClickEditFileOneDrive" href="javascript:;">{{app.tl(\'Edit Online\')}}</a>\n        \x3c!-- /ko --\x3e\n        \x3c!-- ko if: ![\'icon\', \'link\'].includes(type) --\x3e\n            <button type="submit" class="action ladda-button btn btn-default btn-sm btn-mr"\n                        data-style="expand-right" data-bind="ladda:isLoading,click:$data.OnClickEditFileOneDrive">\n                <i class="fa fa-pencil" style="margin-right: 5px;"></i>\n                <span class="ladda-spinner"></span>\n                <span class="ladda-label fileButtons-resp-button-text">{{app.tl(\'Edit Online\')}}</span>\n            </button>\n        \x3c!-- /ko --\x3e\n    \x3c!-- /ko --\x3e\n\n    \x3c!-- ko if: !isCloudStorageFile()  --\x3e\n        \x3c!-- ko if: type == \'link\' --\x3e\n            \x3c!--ko if: !isLocked() || canUnlock() --\x3e\n                <a class="fileLink" data-bind="click: isLocked() ? $data.OnClickUnlockFile : $data.OnClickEditFile"\n                    href="javascript:;">{{isLocked() ? unlockPrompt : app.tl(\'Edit File\')}}</a>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n\n\n        \x3c!-- ko if: type == \'icon\' --\x3e\n            \x3c!-- ko if: !isLocked() && canLock() --\x3e\n                <a class="fileEdit" data-bind="click:$data.OnClickEditFile" href="javascript:;"><i class=\'fa fa-pencil\' aria-hidden="true"></i></a>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: isLocked() --\x3e\n                <a class="fileEdit" data-bind="click:$data.OnClickUnlockFile, tippedDelegate"\n                    data-tipped-options="hideOn:false, hideAfter:300"\n                    data-content="{{tippedContent}}" href="javascript:;">\n                    <i class=\'fa fa-key\' aria-hidden="true"></i>\n                </a>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n\n\n        \x3c!-- ko if: ![\'link\', \'icon\'].includes(type) --\x3e\n                \x3c!-- ko if: !isLocked() && canLock() --\x3e\n                    <button type="submit" class="action ladda-button btn btn-default btn-sm btn-mr"\n                            data-style="expand-right" data-bind="ladda:isLoading,click:$data.OnClickEditFile">\n                        <i class="fa fa-pencil" style="margin-right: 5px;"></i>\n                        <span class="ladda-spinner"></span>\n                        <span class="ladda-label fileButtons-resp-button-text">{{app.tl(\'Edit\')}}</span>\n                    </button>\n                \x3c!-- /ko --\x3e\n                \x3c!-- ko if: !hidden && isLocked() --\x3e\n                    \x3c!-- ko if: isLockedBySelf() --\x3e\n                        <button class="action ladda-button btn btn-primary btn-sm btn-mr btn-file-locked tipped"\n                                    data-style="expand-right" data-bind="ladda:isLoading,click:OnClickUnlockFile, attr:{\'data-tipped\': app.tl(\'Locked for editing by you, since [_s]\',isLockedSince())}">\n                                <i class="fa fa-key" aria-hidden="true"></i>\n                                <span class="ladda-spinner"></span>\n                                <span class="ladda-label fileButtons-resp-button-text" style="color:white;" data-tipped-options="hideAfter: 300">{{app.tl(\'Unlock\')}}</span>\n                        </button>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: !isLockedBySelf() --\x3e\n                        <button class="action btn btn-primary btn-sm btn-mr btn-file-locked" style="color:white; cursor:pointer"\n                                data-bind="tippedDelegate"\n                                data-tipped-options="hideOn:false, hideAfter:300"\n                                data-content="{{tippedContent}}">\n                            <span>\n                                <i class="fa fa-key" aria-hidden="true"></i>\n                            </span>\n                        </button>\n                    \x3c!-- /ko --\x3e\n                \x3c!-- /ko --\x3e\n            \x3c!-- /ko --\x3e\n    \x3c!-- /ko --\x3e\n\x3c!--/ko--\x3e'},3065:function(t,e){t.exports='{{app.tl(\'Locked for editing by [_s] [_s]\', isLockedByName(), isLockedSince())}}\n\x3c!-- ko if: canUnlock() --\x3e\n\t(<a href="javascript:;" data-bind="click:OnClickUnlockFile" style="color: white;">{{unlockPrompt}}</a>)\n\x3c!--/ko--\x3e'},3067:function(t,e){t.exports='\x3c!--ko if: file != null && !isLoading() --\x3e\n\n\t\x3c!-- ko if: mode() == "button" --\x3e\n\n\t\t\x3c!-- ko if: !hideButton() --\x3e\n\n\t\t\t\x3c!-- ko if: file.isPlayableVideo() || file.isBlockedVideo() --\x3e\n\n\t\t\t\t\x3c!-- ko if: file.isPlayableVideo() --\x3e\n\t\t\t\t\t<button type="button" class="btn btn-sm btn-default btn-mr" data-bind="click: OnClickViewFilePreviewButton,attr:{title:app.tl(\'View\')}">\n\t\t\t\t\t\t<i class="fa fa-play" aria-hidden="true"></i>\n\t\t\t\t\t\t<span class="fileButtons-resp-button-text">{{app.tl( \'Play Video\' )}}</span>\n\t\t\t\t\t</button>\n\t\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t\t\x3c!-- ko if: file.isBlockedVideo() --\x3e\n\t\t\t\t\t<button type="button" class="btn btn-default btn-sm tipped" data-bind="attr:{ data-tipped: app.tl(\'This video format is not supported. [_s]More info[_s].\',\'<a style=\\\'color:#fff\\\' target=\\\'_blank\\\' href=\\\'\' + app.consts.HELPDOCS.URL+\'/\'+app.consts.HELPDOCS.FILES.ROUTE+\'/\'+app.consts.HELPDOCS.FILES.ARTICLE.VIDEO_FORMATS + \'\\\'>\',\'</a>\') }" data-tipped-options="hideAfter: 300">\n\t\t\t\t\t\t<i class="fa fa-play" aria-hidden="true"></i>\n\t\t\t\t\t\t<span class="fileButtons-resp-button-text disabledSubmit">{{app.tl( \'Play Video\' )}}</span>\n\t\t\t\t\t</button>\n\t\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\t\x3c!-- ko ifnot: file.isPlayableVideo() || file.isBlockedVideo() --\x3e\n\t\t\t\t<button type="button" class="btn btn-default btn-sm btn-mr" title="{{ app.tl(\'View\') }}" data-bind="click: OnClickViewFilePreviewButton">\n\t\t\t\t\t<i class="fa fa-search"></i>\n\t\t\t\t\t<span class="fileButtons-resp-button-text">{{ buttonText }}</span>\n\t\t\t\t</button>\n\t\t\t\x3c!-- /ko --\x3e\n\n\t\t\x3c!-- /ko --\x3e\n\n\t\x3c!-- /ko --\x3e\n\n\t\x3c!-- ko if: mode() == "icon" --\x3e\n\t\t<a data-bind="click: OnClickViewFile, clickBubble: false, attr: { href:\'./?action=viewFile&fileId=\' + ko.unwrap( file.id ) + \'&v=\' + ko.unwrap( file.version ) + \'&display=true\'}" class="image" target="_blank">\n\t\t\t\x3c!--ko if: ko.unwrap( file.latestVersion ) > 1 --\x3e\n\t\t\t\t<span class="version-badge">v{{file.version}}</span>\n\t\t\t\x3c!--/ko--\x3e\n\t\t\t\x3c!-- ko if: file.thumbURL() --\x3e\n\t\t\t\t\x3c!-- Show Image Thumbnail if one can be generated  --\x3e\n\t\t\t\t<img data-bind="attr: {\'src\': file.isDisplayableImage() || file.fileSource() == \'onedrivebusiness\' || file.fileSource() == \'sharepoint\' ?  file.finalThumbURL() : \'//cdn.teamwork.com/images/newui/file-icons/large/\' + app.GetIcon( file.originalName()) }, event:{ error: app.OnImageThumbLoadFail.bind($data,\'file\') }, css: { \'is-thumbnail\': file.isDisplayableImage(), \'is-icon\': !file.isDisplayableImage() }" class="thumbnail-link__image" loading="lazy" alt="">\n\t\t\t\x3c!--/ko--\x3e\n\t\t\t\x3c!-- ko ifnot: file.thumbURL() --\x3e\n\t\t\t\t\x3c!-- Show icon to specific file extension  --\x3e\n\t\t\t\t<img class="is-icon" data-bind="attr: { src: ko.unwrap(file.fileSourceDisplay.icon) }, event: { error: app.OnImageThumbLoadFail.bind(file,\'file\') }" alt="" />\n\t\t\t\x3c!--/ko--\x3e\n\t\t</a>\n\t\t<a class="twDL" style="display:none" data-bind="attr: {id:\'twDL\' + file.id() ,href: \'./?action=viewFile&fileId=\'+file.id()}" target="_blank">\n\t\t\t{{app.tl(\'Download\')}}\n\t\t</a>\n\t\x3c!-- /ko --\x3e\n\n\t\x3c!-- ko if: mode() == "thumbnailLink" --\x3e\n\t\t<a href="{{\'./?action=viewFile&fileId=\' + ko.unwrap( file.id ) + \'&v=\' + ko.unwrap( file.version ) + \'&display=true\'}}" data-bind="click: OnClickViewFile, clickBubble: false" class="thumbnail-link" target="_blank">\n\t\t\t\x3c!--ko if: ko.unwrap( file.latestVersion ) > 1 --\x3e\n\t\t\t\t<span class="thumbnail-link__version">v{{file.version}}</span>\n\t\t\t\x3c!--/ko--\x3e\n\t\t\t<span class="thumbnail-link__image-hold">\n\t\t\t\t\x3c!-- ko if: file.thumbURL() --\x3e\n\t\t\t\t\t<img data-bind="attr: {\'src\': file.isDisplayableImage() || file.fileSource() == \'onedrivebusiness\' ?  file.finalThumbURL() : \'//cdn.teamwork.com/images/newui/file-icons/large/\' + app.GetIcon( file.originalName()) }, event:{ error: app.OnImageThumbLoadFail.bind($data,\'file\') }, css: { \'is-thumbnail\': file.isDisplayableImage(), \'is-icon\': !file.isDisplayableImage() }" loading="lazy" class="thumbnail-link__image" alt="" />\n\t\t\t\t\x3c!-- /ko --\x3e\n\t\t\t\t\x3c!-- ko ifnot: file.thumbURL() --\x3e\n\t\t\t\t\t<img class="is-icon" data-bind="attr: { src: ko.unwrap(file.fileSourceDisplay.icon) }, event: { error: app.OnImageThumbLoadFail.bind(file,\'file\') }" alt="" />\n\t\t\t\t\x3c!--/ko--\x3e\n\t\t\t</span>\n\t\t</a>\n\t\t<a class="twDL" style="display:none" data-bind="attr: {id:\'twDL\' + file.id() ,href: \'./?action=viewFile&fileId=\'+file.id()}" target="_blank">\n\t\t\t{{app.tl(\'Download\')}}\n\t\t</a>\n\t\x3c!-- /ko --\x3e\n\n\t\x3c!-- ko if: mode() == "name" --\x3e\n\t\t<a data-bind="click: OnClickViewFile,clickBubble:false,attr:{href:\'./?action=viewFile&fileId=\' + ko.unwrap( file.id ) + \'&v=\' + ko.unwrap( file.version ) + \'&display=true\'}" class="filename" target="_blank">\n            {{ app.utility.StripExtension(file.displayName(), file.extension(), 90) }}{{ file.extension() != \'\' ? \'.\' + file.extension() : \'\' }}\n\t\t</a>\n\t\x3c!-- /ko --\x3e\n\n\t\x3c!-- ko if: mode() == "attachment" --\x3e\n\n\t\t<div class="w-file-view">\n\t\t\t<a href="#0" class="w-file-view__block" data-tipped-options="hideAfter: 300" data-bind="css: {tipped: file.isBlockedVideo(), not-thumbnail: !file.thumbnail()},click: OnClickViewFile, clickBubble: false, attr: { href: \'./?action=viewFile&fileId=\' + ko.unwrap( file.id ) + \'&v=\' + ko.unwrap( file.version ) + \'&display=true\', data-tipped: app.tl(\'This video format is not supported. [_s]More info[_s].\',\'<a style=\\\'color:#fff\\\' target=\\\'_blank\\\' href=\\\'\' + app.consts.HELPDOCS.URL+\'/\'+app.consts.HELPDOCS.FILES.ROUTE+\'/\'+app.consts.HELPDOCS.FILES.ARTICLE.VIDEO_FORMATS + \'\\\'>\',\'</a>\'), title: file.name}" target="_blank">\n\t\t\t\t\x3c!-- ko if: file.thumbnail() --\x3e\n\t\t\t\t\t<span class="w-file-view__thumbnail" data-bind="style: { \'backgroundImage\': \'url(\'+ file.thumbnail() +\')\' }">\n\t\t\t\t\t\t\x3c!-- ko if: isPrivate() > 0 --\x3e\n\t\t\t\t\t\t\t<div class="w-file-view__privacy">\n\t\t\t\t\t\t\t\t\x3c!-- ko component: { name:"widget-privacy-icon", params: {private: isPrivate(), lockdownId: lockdownId(), projectId: $parent.projectId, id: file.fileId(), title: file.name(), extraInfo: {fileVersionId: file.version()}, type: \'file\'} } --\x3e\n\t\t\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\t\t\t\t\t\t<img data-bind="attr: {\'src\': file.thumbnail() }, event:{error: app.OnImageThumbLoadFail.bind($data,\'file\')}" class="h-visually-hidden w-file-view__img" alt="{{file.name}}" />\n\t\t\t\t\t</span>\n\t\t\t\t\x3c!--/ko--\x3e\n\t\t\t\t\x3c!-- ko ifnot: file.thumbnail() --\x3e\n\t\t\t\t\t<span class="w-file-view__thumbnail">\n\t\t\t\t\t\t\x3c!-- ko if: isPrivate() > 0 --\x3e\n\t\t\t\t\t\t\t<div class="w-file-view__privacy">\n\t\t\t\t\t\t\t\t\x3c!-- ko component: { name:"widget-privacy-icon", params: {private: isPrivate(), lockdownId: lockdownId(), projectId: $parent.projectId, id: file.fileId(), title: file.name(), extraInfo: {fileVersionId: file.version()}, type: \'file\'} } --\x3e\n\t\t\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!-- /ko --\x3e\n\t\t\t\t\t\t<img data-bind="attr: {src: \'//cdn.teamwork.com/images/newui/file-icons/medium/\' + app.GetIcon( ko.unwrap( file.filename ) ) }, event:{error: app.OnImageThumbLoadFail.bind(file,\'file\')}" loading="lazy" class="w-file-view__img" alt="{{file.name}}" />\n\t\t\t\t\t</span>\n\t\t\t\t\x3c!--/ko--\x3e\n\t\t\t\t<span class="w-file-view__name">\n\t\t\t\t\t<span class="w-file-view__name-label">{{ file.name }}</span>\n\t\t\t\t\t<span class="w-file-view__size-label">{{ file.filesize }}</span>\n\t\t\t\t</span>\n\t\t\t</a>\n\t\t\t<a href="#0" class="w-file-view__download tipped-hide" data-bind="attr: {href: \'./?action=viewFile&display=false&fileId=\'+file.id(), \'data-tipped\': app.tl(\'Download\')}" aria-label="{{app.tl(\'Download File\')}}" target="_blank">\n\t\t\t\t<i class="fa fa-cloud-download" aria-hidden="true"></i>\n\t\t\t</a>\n\t\t</div>\n\n\t\x3c!-- /ko --\x3e\n\n\t\x3c!-- ko if: mode() == "image" --\x3e\n\t\t\x3c!-- ko if: file.thumbURL && file.thumbURL() --\x3e\n\t\t\t<img data-bind="attr:{\'src\': file.thumbURL() }, event:{error:app.OnImageThumbLoadFail.bind($data,\'file\')}" class="iconImg" loading="lazy" style="max-height:100px" alt="" />\n\t\t\x3c!--/ko--\x3e\n\t\t\x3c!-- ko ifnot: file.thumbURL && file.thumbURL() --\x3e\n\t\t\t<img data-bind="attr:{src:\'//cdn.teamwork.com/images/newui/file-icons/medium/\' + app.GetIcon( ko.unwrap( file.originalName ) ) }, event:{error:app.OnImageThumbLoadFail.bind(file,\'file\')}" style="" alt="" />\n\t\t\x3c!--/ko--\x3e\n\t\x3c!-- /ko --\x3e\n\n\x3c!-- /ko --\x3e\n'},4219:function(t,e,i){(function(n){var o,a,s=function(t,e){return function(){return t.apply(e,arguments)}};o=[i(3061),i(1120),i(1190),i(1116),i(1189),i(1282),i(1118)],void 0!==(a=function(t,e,i,o,a,l,r){var c;return c=function(){function t(t){var e,i,o,a,l,r,c,d,p,u,f,h,m;if(null==t&&(t={}),this.ResetAttachmentLists=s(this.ResetAttachmentLists,this),this.insertLinkedFilesRows=s(this.insertLinkedFilesRows,this),this.initialiseDropZone=s(this.initialiseDropZone,this),this.isDropTitleShown=s(this.isDropTitleShown,this),this.OnClickCancelSpecificUpload=s(this.OnClickCancelSpecificUpload,this),this.OnClickSharePointUI=s(this.OnClickSharePointUI,this),this.OnClickOneDriveBusinessUI=s(this.OnClickOneDriveBusinessUI,this),this.OnClickOneDriveUI=s(this.OnClickOneDriveUI,this),this.OnClickBoxComUI=s(this.OnClickBoxComUI,this),this.OnClickGoogleDriveUI=s(this.OnClickGoogleDriveUI,this),this.OnClickDropboxUI=s(this.OnClickDropboxUI,this),this.OnSelectFromExistingFiles=s(this.OnSelectFromExistingFiles,this),this.subscriptions=[],this.params=t,this.item=ko.unwrap(this.params.item),this.type=this.params.type,this.mode=null!=(i=this.params).mode?i.mode:i.mode="inline",this.theme=null!=(o=this.params).theme?o.theme:o.theme="addOrSelect",this.projectId=app.currentRoute().projectId,this.modalRendered=ko.observable(!1),this.onlyOneFile=ko.observable(null!=(a=this.params).onlyOneFile?a.onlyOneFile:a.onlyOneFile=!1),this.enableInnerScrolling=null!=(u=this.params.enableInnerScrolling)?u:app.isBoardsView(),this.innerScrollingHeight=null!=(f=this.params.innerScrollingHeight)?f:250,this.defaultPrivacyIdsArray=null!=(h=t.defaultPrivacyIds)?h:null,this.parentVM=null!=(l=this.params).parentVM?l.parentVM:l.parentVM=null,this.parentModal="",this.parentVM&&(this.attachedProjectId=ko.unwrap(this.parentVM.projectId),this.projectId=this.attachedProjectId,null==this.projectId&&(this.projectId=0),this.parentModal=this.parentVM.parentModal),console.assert(null!==this.attachedProjectId,"Error: missing attached projectId"),this.dropzoneTarget="viewModel/WidgetFileAttachmentDropzone/widget-file-dropzone-"+this.params.notifyKey,this.shared=app.shared.get(this.dropzoneTarget),this.subscriptions.push(this.shared),this.shared(this),this.fileDropZoneShowing=ko.observable(!1),t.showOnLoad&&this.fileDropZoneShowing(!0),this.genericUpload=ko.observable(!!t.genericUpload),this.genericUpload()&&(this.theme="AddProjectFiles"),this.attachedTo=null!=(r=this.params).attachedTo?r.attachedTo:r.attachedTo=null,void 0!==this.attachedTo.attachments)for(m=ko.unwrap(this.attachedTo.attachments),d=0,p=m.length;d<p;d++)e=m[d],null==e.checked&&(e.checked=ko.observable(!0));this.subscriptions.push(this.attachmentsCount=ko.pureComputed(function(t){return function(){var e;return null!=(null!=(e=t.attachedTo)?e.attachments:void 0)?t.attachedTo.attachments().length:0}}(this))),0===this.projectId?this.project=ko.observable(null):this.project=app.projectInfo.get(this.projectId),this.uploadedFiles=ko.observableArray([]),this.selectedExistingFiles=ko.observableArray([]),this.subscriptions.push(this.hasFilesPermissions=ko.pureComputed(function(t){return function(){var e,i,n;return"tasklists-template"===(null!=(e=t.project())?e.type():void 0)||(t.genericUpload()||(null!=(i=t.project())?i.permissions.viewMessagesAndFiles():void 0)&&(null!=(n=t.project())?n.permissions.canAddFiles():void 0))}}(this))),this.subscriptions.push(this.canAccessDropbox=ko.pureComputed(function(t){return function(){var e,i;return app.account.integrations.dropbox&&app.account.integrations.dropbox.connected&&app.account.integrations.dropbox.connected()&&(null!=(i=t.project())?i.permissions.canAccessDropbox():void 0)&&("function"==typeof(e=app.account.integrations.dropbox).folder?e.folder():void 0)}}(this))),this.subscriptions.push(this.canAccessGoogleDocs=ko.pureComputed(function(t){return function(){var e,i;return app.account.integrations.googledrive&&app.account.integrations.googledrive.connected&&app.account.integrations.googledrive.connected()&&(null!=(i=t.project())?i.permissions.canAccessGoogleDocs():void 0)&&("function"==typeof(e=app.account.integrations.googledrive).folder?e.folder():void 0)}}(this))),this.subscriptions.push(this.canUploadFilesDirectly=ko.pureComputed(function(t){return function(){var e;return!app.featureFlip.check("disablingdirectfileuploads",{unwrap:!0})||(null!=(e=t.project())&&"function"==typeof e.directFileUploadsEnabled?e.directFileUploadsEnabled():void 0)&&app.account.canUploadFilesDirectly()}}(this))),this.boxPerProjectConnected=ko.observable(!1),this.boxPerProjectFolderSelected=ko.observable(!1),this.dropboxPerProjectConnected=ko.observable(!1),this.dropboxPerProjectFolderSelected=ko.observable(!1),this.oneDrivePerProjectConnected=ko.observable(!1),this.oneDrivePerProjectFolderSelected=ko.observable(!1),0!==ko.unwrap(this.projectId)&&(c=function(t){return function(e){if(null!=e)return!app.utility.isEmptyObject(e.box)&&e.box.enabled()&&e.box.perProjectConnected()&&t.boxPerProjectConnected(!0),app.utility.isEmptyObject(e.box)||""===e.box.folder()||t.boxPerProjectFolderSelected(!0),!app.utility.isEmptyObject(e.dropbox)&&e.dropbox.enabled()&&e.dropbox.perProjectConnected()&&t.dropboxPerProjectConnected(!0),app.utility.isEmptyObject(e.dropbox)||""===e.dropbox.folder()||t.dropboxPerProjectFolderSelected(!0),!app.utility.isEmptyObject(e.onedrive)&&e.onedrive.enabled()&&""!==e.onedrive.account()&&t.oneDrivePerProjectConnected(!0),app.utility.isEmptyObject(e.onedrive)||""===e.onedrive.folder()?void 0:t.oneDrivePerProjectFolderSelected(!0)}}(this),this.integrationsInfo=app.projectInfo.getIntegrations(ko.unwrap(this.projectId)),null!=this.integrationsInfo()&&c(this.integrationsInfo()),this.subscriptions.push(this.integrationsInfo.subscribe(function(t){return function(t){return c(t)}}()))),this.subscriptions.push(this.canAccessBoxFiles=ko.pureComputed(function(t){return function(){var e,i,n,o;return(null!=(e=app.account.integrations.box)?e.enabled():void 0)&&(null!=(i=app.account.integrations.box)&&"function"==typeof i.connected?i.connected():void 0)&&(null!=(n=t.project())&&null!=(o=n.permissions)?o.canAccessBox():void 0)&&(app.account.integrations.box.perProject()&&t.boxPerProjectConnected()&&t.boxPerProjectFolderSelected()||!app.account.integrations.box.perProject()&&app.account.integrations.box.folder())}}(this))),this.subscriptions.push(this.canAccessDropbox=ko.pureComputed(function(t){return function(){var e,i,n,o;return(null!=(e=app.account.integrations.dropbox)?e.enabled():void 0)&&(null!=(i=app.account.integrations.dropbox)&&"function"==typeof i.connected?i.connected():void 0)&&(null!=(n=t.project())&&null!=(o=n.permissions)?o.canAccessDropbox():void 0)&&(app.account.integrations.dropbox.perProject()&&t.dropboxPerProjectConnected()&&t.dropboxPerProjectFolderSelected()||!app.account.integrations.dropbox.perProject()&&app.account.integrations.dropbox.folder())}}(this))),this.subscriptions.push(this.canAccessOneDrive=ko.pureComputed(function(t){return function(){var e,i,n;return"project"===app.account.integrations.onedrive.mode()&&t.oneDrivePerProjectConnected()&&t.oneDrivePerProjectFolderSelected()&&(null!=(i=t.project())?i.permissions.canAccessOneDrive():void 0)||"project"!==app.account.integrations.onedrive.mode()&&("function"==typeof(e=app.account.integrations.onedrive).folder?e.folder():void 0)&&app.account.integrations.onedrive.connected()&&(null!=(n=t.project())?n.permissions.canAccessOneDrive():void 0)}}(this))),this.subscriptions.push(this.canAccessOneDriveBusiness=ko.pureComputed(function(t){return function(){var e,i,n,o,a,s,l;return app.account.integrations.onedrivebusiness&&app.account.integrations.onedrivebusiness.enabled&&app.account.integrations.onedrivebusiness.enabled()&&(null!=(i=t.project())?i.permissions.canAccessOneDriveBusiness():void 0)&&""!==(null!=(n=t.project())&&null!=(o=n.integrations)&&null!=(a=o.onedrivebusiness)&&"function"==typeof a.account?a.account():void 0)&&""!==(null!=(s=t.project())&&null!=(l=s.integrations)&&null!=(e=l.onedrivebusiness)&&"function"==typeof e.folder?e.folder():void 0)}}(this))),this.subscriptions.push(this.canAccessSharePoint=ko.pureComputed(function(t){return function(){var e,i,n,o,a,s,l;return app.account.integrations.sharepoint&&app.account.integrations.sharepoint.enabled&&app.account.integrations.sharepoint.enabled()&&(null!=(i=t.project())?i.permissions.canAccessSharePoint():void 0)&&""!==(null!=(n=t.project())&&null!=(o=n.integrations)&&null!=(a=o.sharepoint)&&"function"==typeof a.account?a.account():void 0)&&""!==(null!=(s=t.project())&&null!=(l=s.integrations)&&null!=(e=l.sharepoint)&&"function"==typeof e.folder?e.folder():void 0)}}(this))),this.subscriptions.push(app.ko.postbox.subscribe("allTWEvents",function(t){return function(e){var i,n,o;if(e.actionType===app.consts.ACTIONTYPE.ADDED&&"project-file-added"===e.subType&&(null!=(n=e.extraInfo)?n.cloudFileLinked:void 0)&&(null!=(o=e.extraInfo)?o.dropzoneTarget:void 0)===t.dropzoneTarget&&(i=app.ko.mapping.fromJS(e.addedItems),i().length))return t.linkedCategoryId=i()[0].categoryId(),t.insertLinkedFilesRows(i)}}(this))),this.subscriptions.push(app.ko.postbox.subscribe("widget-file-dropzone-"+this.params.notifyKey,function(t){return function(e){var i,n,o,a,s,l;if("showDropZone"===e.action&&(t.fileDropZoneShowing(e.clicked),e.clicked||t.ResetAttachmentLists()),"attachedFilesReady"===e.action&&null!=e.fileInfo&&(!1===t.onlyOneFile()||0===t.uploadedFiles().length&&0===t.selectedExistingFiles().length&&0===t.attachmentsCount()?(t.fileDropZoneShowing(!0),e.fileInfo.checked=ko.observable(!0),e.fileInfo.uploaded=ko.observable(!1),e.fileInfo.categoryId=ko.observable(0),e.fileInfo.icon="//cdn.teamwork.com/images/filetypes/"+app.utility.GetAttachmentIcon(e.fileInfo.name),t.uploadedFiles.push(e.fileInfo),t.attachmentCheck()):app.flash.Error(app.tl("Only one file can be attached, please delete the current file before adding another"))),"selectedFiles"===e.action&&null!=e.fileInfo){for(o=e.fileInfo,i=0,n=o.length;i<n;i++)l=o[i],l.checked=ko.observable(!0),l.icon="//cdn.teamwork.com/tko/public/images/icons/attached/"+app.utility.GetAttachmentIcon(ko.unwrap(l.originalName)),t.selectedExistingFiles.push(l);app.utility.Highlight("li.js-selectExistingFiles .w-uploaded-files__file-name"),t.attachmentCheck()}if(!("amazonS3"!==(a=e.action)&&"attachmentsEdited"!==a||"failure"!==(s=e.subType)&&"remove-cancelled"!==s||null==e.itemId))return t.uploadedFiles(ko.unwrap(t.uploadedFiles).filter(function(t){return ko.unwrap(t).ref!==e.itemId})),t.attachmentCheck()}}(this))),this.subscriptions.push(this.attachedFilesCount=ko.pureComputed(function(t){return function(){return t.getCheckedSelected(t.uploadedFiles()).length+t.getCheckedSelected(t.selectedExistingFiles()).length}}(this))),this.subscriptions.push(this.modalIsReady=ko.pureComputed(function(t){return function(){return app.fileDropEnabled()&&t.hasFilesPermissions()&&t.modalRendered()}}(this))),this.subscriptions.push(this.modalIsReady.subscribe(function(t){return function(e){if(null!=e&&e)return n(".w-file-dropzone."+t.params.notifyKey).parents(".is-drop-zone").length||window.devMode&&console.error("ERROR: no valid dropzone found"),t.initialiseDropZone()}}(this))),app.InitOnShow(this),this.readyToShow(!0)}return t.prototype.OnShow=function(){setTimeout(function(t){return function(){return t.modalRendered(!0)}}(this),200)},t.prototype.OnClickIncludeFile=function(t){return this.attachmentCheck(),!0},t.prototype.OnSelectFromExistingFiles=function(){var t;Tipped.hideAll(),app.ko.postbox.publish("froala-hide-all-popups",{}),t=function(t){return function(t){}}(),app.modal.Show("selectExistingFiles",{stack:!0,onCloseCallBack:t,projectId:this.attachedProjectId},this)},t.prototype.OnClickDropboxUI=function(){return Tipped.hideAll(),app.ko.postbox.publish("froala-hide-all-popups",{}),app.modal.Show("cloudFileBrowser",{type:"dropbox",folderType:"uploadFiles",projectId:ko.unwrap(this.projectId),parentModal:this.parentModal,dropzoneTarget:this.dropzoneTarget,defaultPrivacyIds:ko.unwrap(this.defaultPrivacyIdsArray)})},t.prototype.OnClickGoogleDriveUI=function(){return Tipped.hideAll(),app.ko.postbox.publish("froala-hide-all-popups",{}),app.modal.Show("cloudFileBrowser",{type:"googledrive",folderType:"uploadFiles",projectId:ko.unwrap(this.projectId),parentModal:this.parentModal,dropzoneTarget:this.dropzoneTarget,defaultPrivacyIds:ko.unwrap(this.defaultPrivacyIdsArray)})},t.prototype.OnClickBoxComUI=function(){return Tipped.hideAll(),app.ko.postbox.publish("froala-hide-all-popups",{}),app.modal.Show("cloudFileBrowser",{type:"box",folderType:"uploadFiles",projectId:ko.unwrap(this.projectId),parentModal:this.parentModal,dropzoneTarget:this.dropzoneTarget,defaultPrivacyIds:ko.unwrap(this.defaultPrivacyIdsArray)})},t.prototype.OnClickOneDriveUI=function(){return Tipped.hideAll(),app.ko.postbox.publish("froala-hide-all-popups",{}),app.modal.Show("cloudFileBrowser",{type:"onedrive",folderType:"uploadFiles",projectId:ko.unwrap(this.projectId),parentModal:this.parentModal,dropzoneTarget:this.dropzoneTarget,defaultPrivacyIds:ko.unwrap(this.defaultPrivacyIdsArray)})},t.prototype.OnClickOneDriveBusinessUI=function(){return Tipped.hideAll(),app.ko.postbox.publish("froala-hide-all-popups",{}),app.modal.Show("cloudFileBrowser",{type:"onedrivebusiness",folderType:"uploadFiles",projectId:ko.unwrap(this.projectId),parentModal:this.parentModal,dropzoneTarget:this.dropzoneTarget,defaultPrivacyIds:ko.unwrap(this.defaultPrivacyIdsArray)})},t.prototype.OnClickSharePointUI=function(){return Tipped.hideAll(),app.ko.postbox.publish("froala-hide-all-popups",{}),app.modal.Show("cloudFileBrowser",{type:"sharepoint",folderType:"uploadFiles",projectId:ko.unwrap(this.projectId),parentModal:this.parentModal,dropzoneTarget:this.dropzoneTarget,defaultPrivacyIds:ko.unwrap(this.defaultPrivacyIdsArray)})},t.prototype.OnClickCancelSpecificUpload=function(t){return app.s3UploadManager.cancelAttachmentsUpload(this.currentAddFile.s3,t)},t.prototype.isDropTitleShown=function(){var t,e,i;return t=0===this.uploadedFiles().length&&0===this.selectedExistingFiles().length&&0===this.attachmentsCount(),e="AddProjectFiles"!==this.theme,i=this.canUploadFilesDirectly(),t&&e&&i},t.prototype.initialiseDropZone=function(){return this.currentAddFile=new l({form:n(".w-file-dropzone."+this.params.notifyKey),filesList:n(".w-file-dropzone."+this.params.notifyKey+" .w-file-dropzone__files-wrapper"),projectId:this.projectId,dropZone:n(".w-file-dropzone."+this.params.notifyKey).parents(".is-drop-zone"),inTKOWidget:!0,uniqueKey:this.params.notifyKey,showOverlay:!0,tkoTaskNotify:null!=ko.unwrap(this.attachedTo).componentName&&"task"===ko.unwrap(this.attachedTo).componentName.toLowerCase()?this.parentVM.uniqueId:""})},t.prototype.insertLinkedFilesRows=function(t){var e,i,n,o;for(o=t(),e=0,i=o.length;e<i;e++)n=o[e],n.checked=ko.observable(!0),n.type="cloudFileLinked",null==n.icon&&(n.icon="//cdn.teamwork.com/tko/public/images/icons/attached/raster.png");return this.selectedExistingFiles.push.apply(this.selectedExistingFiles,t()),app.utility.Highlight("li.js-selectExistingFiles .fileDropZoneAddedFile")},t.prototype.ResetAttachmentLists=function(){return this.uploadedFiles([]),this.selectedExistingFiles([])},t.prototype.getCheckedSelected=function(t){return ko.utils.arrayFilter(t,function(t){return ko.unwrap(t.checked)}).map(function(t){return t.ref?t.ref:t.id()})},t.prototype.getCheckedSelectedCats=function(t){return ko.utils.arrayFilter(t,function(t){return ko.unwrap(t.checked)}).map(function(t){return""===t.categoryId()?0:t.categoryId()})},t.prototype.getAttachmentIcon=function(t){var e;return e=null!=t.originalName?t.originalName():null!=t.filename?t.filename():t.fileName(),"//cdn.teamwork.com/images/filetypes/"+app.utility.GetAttachmentIcon(e)},t.prototype.getSavedFileAttachmentsIds=function(t){var e;return e=[],null!=t&&null!=t.attachments&&(e=this.getCheckedSelected(t.attachments())),e},t.prototype.getSavedFileAttachmentsCats=function(t){var e;return e=[],null!=t&&null!=t.attachments&&(e=this.getCheckedSelectedCats(t.attachments())),e},t.prototype.arrayToString=function(t){return 0===t.length?"":t.join(",")},t.prototype.buildNewFileCategories=function(){return this.arrayToString(this.getCheckedSelectedCats(this.uploadedFiles()))},t.prototype.buildFileIds=function(t){return this.arrayToString(this.getCheckedSelected(this.selectedExistingFiles()).concat(this.getSavedFileAttachmentsIds(t)))},t.prototype.buildExistingFileCategories=function(t){return this.arrayToString(this.getCheckedSelectedCats(this.selectedExistingFiles()).concat(this.getSavedFileAttachmentsCats(t)))},t.prototype.attachmentCheck=function(){var t,e,i,n,o,a,s,l,r,c;if(e="unedited",(null!=(r=ko.unwrap(this.attachedTo.attachments))?r.length:void 0)>0)for(c=ko.unwrap(this.attachedTo.attachments),n=0,a=c.length;n<a;n++)if(t=c[n],!1===t.checked()){e="edited";break}if("unedited"===e&&(l=ko.unwrap(this.selectedExistingFiles).concat(ko.unwrap(this.uploadedFiles)),(null!=l?l.length:void 0)>0))for(o=0,s=l.length;o<s;o++)if(i=l[o],!0===i.checked()){e="edited";break}return app.s3UploadManager.attachmentsEdited(this.params.notifyKey,e)},t.prototype.dispose=function(){null!=this.subscriptions&&this.subscriptions.forEach(function(t){return t.dispose()}),null!=this.currentAddFile&&(this.currentAddFile.dropZone.find(".u-upload-overlay").remove(),app.s3UploadManager.removeInactive())},t}(),{viewModel:c,template:t}}.apply(e,o))&&(t.exports=a)}).call(e,i(245))},4220:function(t,e,i){(function(n){var o,a;o=[i(3062),i(1120),i(1190),i(1116),i(1189),i(1282),i(1118)],void 0!==(a=function(t,e,i,o,a,s,l){var r;return r=function(){function t(t){var e,i,n,o,a;null==t&&(t={}),this.subscriptions=[],this.params=t,this.item=ko.unwrap(this.params.item),this.type=this.params.type,this.mode=null!=(e=this.params).mode?e.mode:e.mode="inline",this.theme=null!=(i=this.params).theme?i.theme:i.theme="addOrSelect",this.onlyOneFile=ko.observable(null!=(n=this.params).onlyOneFile?n.onlyOneFile:n.onlyOneFile=!1),this.parentVM=null!=(o=this.params).parentVM?o.parentVM:o.parentVM=null,this.parentVM&&(this.attachedProjectId=ko.unwrap(this.parentVM.projectId)),console.assert(null!==this.attachedProjectId,"Error: missing attached projectId"),this.shared=app.shared.get("viewModel/WidgetFileAttachmentInline/widget-file-dropzone-inline-"+this.params.notifyKey),this.subscriptions.push(this.shared),this.shared(this),this.fileDropZoneShowing=ko.observable(!1),t.showOnLoad&&this.fileDropZoneShowing(!0),this.attachedTo=null!=(a=this.params).attachedTo?a.attachedTo:a.attachedTo=null,this.subscriptions.push(this.attachmentsCount=ko.pureComputed(function(t){return function(){var e;return null!=(null!=(e=t.attachedTo)?e.attachments:void 0)?t.attachedTo.attachments().length:0}}(this))),this.project=app.projectInfo.get(this.attachedProjectId),this.subscriptions.push(app.ko.postbox.subscribe("widget-file-dropzone-"+this.params.notifyKey,function(t){return function(e){if("attachedFilesReady"===e.action&&null!=e.fileInfo&&(e.fileInfo.checked=ko.observable(!0),e.fileInfo.uploaded=ko.observable(!1),e.fileInfo.categoryId=ko.observable(0),e.fileInfo.categoryName=ko.observable(""),t.uploadedFiles.push(e.fileInfo)),"attachedFilesReady"===e.action&&e.ready)return t.parentVM.OnDragPasteFiles(),t.uploadedFiles([])}}(this))),this.uploadedFiles=ko.observableArray([]),this.fileUploadingMessage=ko.pureComputed(function(t){return function(){return null==t.currentAddFile?"":t.currentAddFile.s3.files.currentOArray().length>1?app.tl("Uploading [_s] files",t.currentAddFile.s3.files.currentOArray().length):app.tl("Uploading [_s] file",1)}}(this)),this.subscriptions.push(this.fileUploadingMessage),app.InitOnShow(this),this.readyToShow(!0)}return t.prototype.OnShow=function(){app.fileDropEnabled()&&(n("div.fileDropZone."+this.params.notifyKey).parents(".is-drop-zone").length||window.devMode&&console.error("ERROR: no valid dropzone found"),this.currentAddFile=new s({form:n("div.fileDropZone."+this.params.notifyKey),filesList:n("div.fileDropZone."+this.params.notifyKey+" .mfpSelectedFiles"),projectId:this.attachedProjectId,dropZone:n("div.fileDropZone."+this.params.notifyKey).parents(".is-drop-zone"),inTKOWidget:!0,uniqueKey:this.params.notifyKey,showOverlay:!0,tkoTaskNotify:null!=ko.unwrap(this.attachedTo).componentName&&"task"===ko.unwrap(this.attachedTo).componentName.toLowerCase()?this.parentVM.uniqueId:""}))},t.prototype.OnClickCancelUploadInline=function(){return app.s3UploadManager.cancelAttachmentsUpload(this.currentAddFile.s3,this.uploadedFiles())},t.prototype.getCheckedSelected=function(t){return ko.utils.arrayFilter(t,function(t){return ko.unwrap(t.checked)}).map(function(t){return t.ref?t.ref:t.id()})},t.prototype.getCheckedSelectedCats=function(t){return ko.utils.arrayFilter(t,function(t){return ko.unwrap(t.checked)}).map(function(t){return""===t.categoryId()?0:t.categoryId()})},t.prototype.getSavedFileAttachmentsIds=function(t){var e;return e=[],null!=t&&null!=t.attachments&&(e=this.getCheckedSelected(t.attachments())),e},t.prototype.getSavedFileAttachmentsCats=function(t){var e;return e=[],null!=t&&null!=t.attachments&&(e=this.getCheckedSelectedCats(t.attachments())),e},t.prototype.arrayToString=function(t){return 0===t.length?"":t.join(",")},t.prototype.buildNewFileCategories=function(){return this.arrayToString(this.getCheckedSelectedCats(this.uploadedFiles()))},t.prototype.buildFileIds=function(t){return this.arrayToString(this.getCheckedSelected(this.selectedExistingFiles()).concat(this.getSavedFileAttachmentsIds(t)))},t.prototype.buildExistingFileCategories=function(t){return this.arrayToString(this.getCheckedSelectedCats(this.selectedExistingFiles()).concat(this.getSavedFileAttachmentsCats(t)))},t.prototype.dispose=function(){null!=this.subscriptions&&this.subscriptions.forEach(function(t){return t.dispose()}),null!=this.currentAddFile&&app.s3UploadManager.removeInactive()},t}(),{viewModel:r,template:t}}.apply(e,o))&&(t.exports=a)}).call(e,i(245))},4221:function(t,e,i){var n,o,a=function(t,e){return function(){return t.apply(e,arguments)}};n=[i(3063),i(1120),i(1190),i(1116),i(1189)],void 0!==(o=function(t,e,i,n,o){var s;return s=function(){function t(t){var e;null==t&&(t={}),this.OnShowFilePicker=a(this.OnShowFilePicker,this),this.subscriptions=[],this.params=t,this.item=ko.unwrap(this.params.item),this.projectId=this.params.projectId,this.filePickerShowing=ko.observable(!1),this.attachedTo=null!=(e=this.params).attachedTo?e.attachedTo:e.attachedTo=null,this.subscriptions.push(this.attachmentsCount=ko.pureComputed(function(t){return function(){var e;return null!=(null!=(e=t.attachedTo)?e.attachments:void 0)?t.attachedTo.attachments().length:0}}(this))),this.project=app.projectInfo.get(this.projectId),this.subscriptions.push(this.canViewMessagesAndFiles=ko.pureComputed(function(t){return function(){var e,i,n,o,a;return(null!=(e=t.project())&&null!=(i=e.permissions)?i.viewMessagesAndFiles():void 0)&&"1"===(null!=(n=t.project())&&null!=(o=n.activePages)&&null!=(a=o.files())?a.toString():void 0)}}(this))),this.subscriptions.push(this.hasFilesPermissions=ko.pureComputed(function(t){return function(){var e,i;return(null!=(e=t.project())&&null!=(i=e.permissions)?i.canAddFiles():void 0)&&t.canViewMessagesAndFiles()}}(this)))}return t.prototype.OnShowFilePicker=function(){this.filePickerShowing(!0),app.ko.postbox.publish("widget-file-dropzone-"+this.params.notifyKey,{action:"showDropZone",clicked:!0})},t.prototype.dispose=function(){null!=this.subscriptions&&this.subscriptions.forEach(function(t){return t.dispose()})},t}(),{viewModel:s,template:t}}.apply(e,n))&&(t.exports=o)},4222:function(t,e,i){var n,o,a=function(t,e){return function(){return t.apply(e,arguments)}},s=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};n=[i(164),i(3064),i(3065),i(4433),i(14)],void 0!==(o=function(t,e,i,n,o){var l;return l=function(){function e(e){var n;null==e&&(e={}),this.notifyOtherEditors=a(this.notifyOtherEditors,this),this.lockFile=a(this.lockFile,this),this.OnClickUnlockFile=a(this.OnClickUnlockFile,this),this.OpenFile=a(this.OpenFile,this),this.OnClickEditFile=a(this.OnClickEditFile,this),this.OnClickEditFileOneDrive=a(this.OnClickEditFileOneDrive,this),this.tippedContent=i,this.type=t.unwrap(e.type),this.file=t.unwrap(e.item),this.hidden=t.unwrap(e.hidden),null==this.hidden&&this.hidden,null==this.file.cloudStorageCanEdit&&(this.file.cloudStorageCanEdit=t.observable("0")),this.type=this.hidden?"file":this.type,this.subscriptions=[],this.isLoading=t.observable(!1),this.uniqueId="file-editor-"+Date.now(),this.subscriptions.push(app.ko.postbox.subscribe("file-lock-"+this.file.id(),function(e){return function(i){var n,o,a,s;if(null!=i&&(a=i.value,i.id!==e.uniqueId&&e.file.fileLocked()!==s))return s=parseInt(a,10),o=1===s,e.file.fileLocked(s),("function"==typeof(n=e.file).fileLockedBySelf?n.fileLockedBySelf():void 0)?e.file.fileLockedBySelf(o):e.file.fileLockedBySelf=t.observable(o)}}(this))),this.isEditableFile=t.observable((n=this.file.extension(),!(s.call(app.consts.FILES.FORBIDDENFILETYPES,n)>=0))),this.isCloudStorageFile=t.pureComputed(function(t){return function(){var e;return"dropbox"===(e=t.file.fileSource())||"box"===e||"googledrive"===e||"onedrive"===e||"onedrivebusiness"===e||"sharepoint"===e}}(this)),this.isOnlineEditable=t.pureComputed(function(t){return function(){var e;return"1"===t.file.cloudStorageCanEdit()&&(e=t.file.extension(),s.call(app.consts.EDITABLEFILESONDRIVEONLINE,e)>=0)}}(this)),this.subscriptions.push(this.isLocked=t.pureComputed(function(t){return function(){return 1===parseInt(t.file.fileLocked(),10)}}(this))),this.subscriptions.push(this.isLockedBy=t.pureComputed(function(t){return function(){var e;return("function"==typeof(e=t.file).fileLockedByUserId?e.fileLockedByUserId():void 0)?t.file.fileLockedByUserId():-1}}(this))),this.subscriptions.push(this.isLockedBySelf=t.pureComputed(function(t){return function(){var e;return t.isLocked()&&("function"==typeof(e=t.file).fileLockedBySelf?e.fileLockedBySelf():void 0)}}(this))),this.subscriptions.push(this.isLockedSince=t.pureComputed(function(t){return function(){var e,i,n;return t.isLocked()&&("function"==typeof(e=t.file).fileLockedDateTime?e.fileLockedDateTime():void 0)?(n=o(),i=o(t.file.fileLockedDateTime()),i.from(n)):""}}(this))),this.subscriptions.push(this.isLockedByName=t.pureComputed(function(t){return function(){return t.isLocked()&&null!=t.file.fileLockedByUserFirstName?t.file.fileLockedByUserFirstName()+" "+t.file.fileLockedByUserLastName():""}}(this))),this.subscriptions.push(this.unlockPrompt=t.pureComputed(function(t){return function(){return t.isLocked()?t.isLockedBySelf()?app.tl("Unlock"):app.tl("Force Unlock"):""}}(this))),this.project=app.projectInfo.get(this.file.projectId),this.subscriptions.push(this.canUnlock=t.pureComputed(function(t){return function(){var e;return app.loggedInUser.administrator()||("function"==typeof t.project&&null!=(e=t.project())?e.permissions.projectAdministrator():void 0)||t.isLockedBySelf()}}(this))),this.subscriptions.push(this.canLock=t.pureComputed(function(t){return function(){var e,i;return app.loggedInUser.administrator()||("function"==typeof t.project&&null!=(e=t.project())?e.permissions.projectAdministrator():void 0)||("function"==typeof t.project&&null!=(i=t.project())?i.permissions.canAddFiles():void 0)}}(this))),this.subscriptions.push(this.projectIsActive=t.pureComputed(function(t){return function(){var e;return"function"==typeof t.project&&null!=(e=t.project())?e.isActive():void 0}}(this)))}return e.prototype.OnClickEditFileOneDrive=function(){this.isLoading(!0),window.open("./?action=viewFile&fileId="+this.file.id()+"&v="+this.file.version()+"&display=1"),this.isLoading(!1)},e.prototype.OnClickEditFile=function(){var t;this.isLoading(!0),t="",app.api.get("./documentEditor/"+this.file.id()+"/getToken.json?lockFile=false&version="+this.file.version()).then(function(e){return function(i){var n,o,a,s,l;return t=i.response.APIToken,o=i.response.latestVersion,i.response.isLatestVersion?e.OpenFile(e.file.version(),t):(l=app.tl("Edit This Version?"),s=app.tl("You are not editing the latest version of this file. Do you want to continue with this version?"),a=app.tl("Edit Latest Version [_s]","("+o+")"),n=app.tl("Yes"),app.modal.Show("confirm",{title:l,text:s,otherMessage:a,confirmMessage:n,multiChoice:!0,callback:function(i){return i.wasCancelled?e.OnClickUnlockFile():i.Other?e.OpenFile(o,t):e.OpenFile(e.file.version(),t)}}))}}(this)).catch(function(t){return function(e){return t.file.fileLocked(0)}}(this)).finally(function(t){return function(){return t.notifyOtherEditors(),t.isLoading(!1)}}(this))},e.prototype.OpenFile=function(t,e){return this.lockFile(),e="EU"===app.account.awsRegion()?e+"-"+t+"-EU":e+"-"+t,window.desktopInterop?void window.desktopInterop.openDocumentEditor(e):window.protocolCheck("teamwork://"+e,function(t){return function(){var i;i=app.utility.GetCookie("ignoreDocEditorTimeout"),"1"===i?app.flash.Info("Couldn't open the Document Editor"):app.modal.Show("documentEditor",{name:"key",value:e,file:t.file})}}(this))},e.prototype.OnClickUnlockFile=function(){this.isLocked()&&this.canUnlock()&&app.api.put("files/"+this.file.id()+"/unlock.json").then(function(e){return function(i){return Tipped.hideAll(),t.postbox.publish("allTWEvents",{eventTime:new Date,itemType:"file",actionType:"edited",itemId:e.file.id(),subType:"file-unlocked"}),app.flash.Success(app.tl("The file was unlocked successfully")),e.file.fileLocked(0)}}(this)).catch(function(t){return function(){return app.flash.Error(app.tl("Sorry, there was a problem trying to unlock the file. Can you try again please?")),t.file.fileLocked(1)}}(this)).finally(function(t){return function(){return t.notifyOtherEditors()}}(this))},e.prototype.lockFile=function(){return Tipped.hideAll(),app.api.put("files/"+this.file.id()+"/lock.json").then(function(e){return function(i){return null!=e.file.fileLocked?e.file.fileLocked(1):e.file.fileLocked=t.observable(1),null!=e.file.fileLockedByUserId?e.file.fileLockedByUserId(app.loggedInUser.id()):e.file.fileLockedByUserId=t.observable(app.loggedInUser.id()),null!=e.file.fileLockedBySelf?e.file.fileLockedBySelf(!0):e.file.fileLockedBySelf=t.observable(!0),null!=e.file.fileLockedDateTime?e.file.fileLockedDateTime(o()):e.file.fileLockedDateTime=t.observable(o()),t.postbox.publish("allTWEvents",{eventTime:new Date,itemType:"file",actionType:"edited",itemId:e.file.id(),subType:"file-locked"})}}(this))},e.prototype.notifyOtherEditors=function(){var t;return t=this.file.fileLocked(),app.ko.postbox.publish("file-lock-"+this.file.id(),{value:t,id:this.uniqueId})},e.prototype.dispose=function(){},e}(),{viewModel:l,template:e}}.apply(e,n))&&(t.exports=o)},4224:function(t,e,i){(function(n,o){var a,s,l=function(t,e){return function(){return t.apply(e,arguments)}},r=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};a=[i(164),i(3067)],void 0!==(s=function(t,e){var i;return i=function(){function e(e){var i,o,a;null==e&&(e={}),this.OnClickViewFile=l(this.OnClickViewFile,this),this.OnClickViewFilePreviewButton=l(this.OnClickViewFilePreviewButton,this),this.OnClickViewFileNewWindow=l(this.OnClickViewFileNewWindow,this),this.OnClickAttachment=l(this.OnClickAttachment,this),this.OnViewAttachmentComments=l(this.OnViewAttachmentComments,this),this.file=t.unwrap(e.item),this.fileWrapped=e.item,this.parent=null!=e.parent?t.unwrap(e.parent):{},this.index=null!=e.index?t.unwrap(e.index):0,this.version=null!=e.version?t.unwrap(e.version):null!=this.file.version?t.unwrap(this.file.version):0,this.getAndShowPrivacy=t.observable(null!=e.getAndShowPrivacy&&e.getAndShowPrivacy),this.isPrivate=t.observable(0),this.lockdownId=t.observable(null),this.buttonText=null!=(i=t.unwrap(e.buttonText))?i:app.tl("Preview"),this.viewButtonText=null!=(o=t.unwrap(e.viewButtonText))?o:app.tl("View"),this.subscriptions=[],this.isLoading=t.observable(!1),this.mode=t.observable(null!=(a=e.mode)?a:"button"),this.fileSource=this.file.fileSource(),this.isLocked=t.observable(t.unwrap(this.file.fileLocked)),e.loadDeferred&&(this.loadDeferred=e.loadDeferred,null!=this.loadDeferred&&console.assert(n.isFunction(this.loadDeferred.promise)),n(".w-attached-files__item img").each(function(t){return function(e,i){return i.addEventListener("load",t.loadDeferred.resolve,!1)}}(this))),this.getAndShowPrivacy()&&null!=e.item.private&&null!=e.item.lockdownId&&(this.isPrivate(t.unwrap(e.item.private)),this.lockdownId(t.unwrap(e.item.lockdownId))),this.subscriptions.push(this.fileTooBig=t.pureComputed(function(e){return function(){return parseInt(t.unwrap(e.file.size(),10))>app.consts.FILEPREVIEWSIZELIMITS.GOOGLE}}(this))),this.subscriptions.push(this.isMicrosoftOfficeFile=t.computed(function(t){return function(){var e;return null!=t.file.extension&&(e=t.file.extension().toLowerCase(),r.call(app.consts.FILES.MICROSOFTOFFICEFILES,e)>=0)}}(this))),this.subscriptions.push(this.isDisplayableImage=t.computed(function(t){return function(){var e;return null!=t.file.extension&&(e=t.file.extension().toLowerCase(),r.call(app.consts.FILES.DISPLAYABLEIMAGE,e)>=0)}}(this))),this.subscriptions.push(this.IsViewableFile=t.computed(function(t){return function(){var e;return null!=t.file.extension&&(e=t.file.extension().toLowerCase(),r.call(app.consts.FILES.VIEWABLEFILETYPES,e)>=0)}}(this))),this.subscriptions.push(this.IsViewableDropboxFile=t.computed(function(t){return function(){var e;return null!=t.file.extension&&(e=t.file.extension().toLowerCase(),r.call(app.consts.FILES.VIEWABLEDROPBOXFILETYPES,e)>=0)}}(this))),this.subscriptions.push(this.hideButton=t.pureComputed(function(t){return function(){var e,i;if(null!=t.file.externalLoginRequired&&"1"===t.file.externalLoginRequired())return!0;if(null!=(null!=(e=app.account)?e.canPreviewFiles:void 0)&&!app.account.canPreviewFiles())return"teamworkpm"!==t.file.fileSource()||!t.isDisplayableImage()&&!t.file.isPlayableVideo();if(t.file.isPlayableVideo()||t.file.isBlockedVideo())return!1;if("onedrive"===t.file.fileSource()&&!t.isDisplayableImage())return!0;if(("onedrivebusiness"===t.file.fileSource()||"sharepoint"===t.file.fileSource())&&(i=t.file.extension().toLowerCase(),r.call(app.consts.FILES.ODB_BLOCKED_PREVIEW,i)>=0||!t.IsViewableFile()&&!t.isDisplayableImage()))return!0;if("teamworkpm"===t.file.fileSource()){if(!t.IsViewableFile()&&!t.isDisplayableImage())return!0;if(t.fileTooBig())return!0}if("dropbox"===t.file.fileSource()){if(!t.IsViewableDropboxFile()&&!t.isDisplayableImage())return!0;if(t.fileTooBig())return!0}return!1}}(this)))}return e.prototype.OnViewAttachmentComments=function(t,e){app.quickView.show("file",{id:t.file.id(),fileId:t.file.fileId(),fileVersion:t.file.version(),projectId:t.file.projectId(),parentFile:t.file})},e.prototype.OnClickAttachment=function(t,e){var i,n;return!e.ctrlKey&&!e.metaKey||(null==(null!=(n=t.file)?n.id:void 0)||(null==(i=o("#twDL"+t.file.id()))||(i[0].click(),e.preventDefault(),!1)))},e.prototype.OnClickViewFileNewWindow=function(t,e){window.open("./?action=viewFile&fileId="+this.file.id()+"&v="+this.version+"&display=true"),this.isLoading(!1)},e.prototype.OnClickViewFilePreviewButton=function(t,e){if(!this.file.isBlockedVideo())return this.OnClickViewFile(t,e,!0)},e.prototype.OnClickViewFile=function(e,i,n){var a,s,l,r,c,d;if(null==n&&(n=!1),i.ctrlKey||i.metaKey){if(n)return window.open("./?action=viewFile&fileId="+this.file.id()+"&v="+this.version+"&display=true"),void this.isLoading(!1);if(s=o("#twDL"+this.file.id()))return s[0].click(),i.preventDefault(),!1}if(!this.file.isBlockedVideo()){if(this.isLoading(!0),"teamworkpm"===this.file.fileSource()&&this.fileTooBig()&&!this.file.isPlayableVideo()||app.isMobile)return window.open("./?action=viewFile&fileId="+this.file.id()+"&v="+this.version+"&display=true"),void this.isLoading(!1);c=null!=this.parent.commentableType?t.unwrap(this.parent.commentableType):"",r=null!=this.parent.commentableId?t.unwrap(this.parent.commentableId):0,"todo_items"===c&&(c="Task"),a={type:c,id:r,projectId:this.file.projectId(),attachedVM:this.parent},l=null!=(d=this.parent.filteredItems)?d:[],null!=this.parent.attachments&&(l=this.parent.attachments),this.hideButton()?window.open("./?action=viewFile&fileId="+this.file.id()+"&v="+this.version+"&display=true"):this.isDisplayableImage()?app.modal.Show("previewImages",{item:this.file,version:this.version,startingIndex:this.index,filteredItems:l,attachedTo:a}):app.modal.Show("previewFile",{file:this.file,version:this.version,startingIndex:this.index,filteredItems:l,attachedTo:a}),this.isLoading(!1)}},e.prototype.dispose=function(){null!=this.subscriptions&&this.subscriptions.forEach(function(t){return t.dispose()})},e}(),{viewModel:i,template:e}}.apply(e,a))&&(t.exports=s)}).call(e,i(245),i(245))},4433:function(t,e,i){(function(t){!function(t){var e,i,n,o,a,s,l,r,c,d,p;i=function(t,e,i){return t.addEventListener?(t.addEventListener(e,i),{remove:function(){t.removeEventListener(e,i)}}):(t.attachEvent(e,i),{remove:function(){t.detachEvent(e,i)}})},e=function(t,e){var i;return i=document.createElement("iframe"),i.src=e,i.id="hiddenIframe",i.style.display="none",t.appendChild(i),i},c=function(n,o){var a,s,l,r;r=setTimeout(function(){o(),a.remove()},2e3),s=document.querySelector("#hiddenIframe"),l=function(){clearTimeout(r),a.remove()},s||(s=e(document.body,"about:blank")),a=i(t,"blur",l),s.contentWindow.location.href=n},p=function(e,n){var o,a,s,l;for(l=setTimeout(function(){n(),o.remove()},2e3),s=t,a=function(){clearTimeout(l),o.remove()};s!==s.parent;)s=s.parent;o=i(s,"blur",a),t.location=e},s=function(t,i){var n,o;(o=document.querySelector("#hiddenIframe"))||(o=e(document.body,"about:blank"));try{o.contentWindow.location.href=t}catch(t){n=t,"NS_ERROR_UNKNOWN_PROTOCOL"===n.name&&i()}},r=function(t,e){10===o()?l(t,e):9===o()||11===o()?c(t,e):a(t,e)},l=function(i,n){var o,a;a=setTimeout(n,3e3),t.addEventListener("blur",function(){clearTimeout(a)}),(o=document.querySelector("#hiddenIframe"))||(o=e(document.body,"about:blank"));try{o.contentWindow.location.href=i}catch(t){t,n(),clearTimeout(a)}},a=function(e,i){var n;n=t.open("","","width=0,height=0"),n.document.write("<iframe src='"+e+"'></iframe>"),setTimeout(function(){try{n.location.href,n.setTimeout("window.close()",2e3)}catch(t){t,n.close(),i()}},2e3)},d=function(t,e){navigator.msLaunchUri(t,function(){},e)},n=function(){var e,i,n;return i=!!t.opera||navigator.userAgent.indexOf(" OPR/")>=0,e=!!t.chrome&&!i,n=Object.prototype.toString.call(t.HTMLElement).indexOf("Constructor")>0||!e&&void 0!==t.VideoTrackList,{isOpera:i,isFirefox:"undefined"!=typeof InstallTrigger,isChrome:!!t.chrome&&!i,isSafari:n,isIE:!!document.documentMode}},o=function(){var t,e,i;return e=-1,"Microsoft Internet Explorer"===navigator.appName?(i=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==t.exec(i)&&(e=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(i=navigator.userAgent,t=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==t.exec(i)&&(e=parseFloat(RegExp.$1))),e},t.protocolCheck=function(e,i){var o,a;if(a=function(){i&&i()},document.cookie.indexOf("TDE=1")>0||document.cookie.indexOf("TDE=2")>0)return void(t.location.href=e);navigator.msLaunchUri?d(e,i):(o=n(),o.isFirefox?s(e,a):o.isChrome?p(e,a):o.isIE?r(e,a):o.isSafari&&p(e,a))}}(window)}).call(e,i(245))}});
//# sourceMappingURL=attachments.67a1ae83f68a465c607d.js.map